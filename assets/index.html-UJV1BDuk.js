import{_ as i,c as a,a as n,o as e}from"./app-D2B0C_7K.js";const l={};function t(h,s){return e(),a("div",null,s[0]||(s[0]=[n(`<h2 id="_0-前言" tabindex="-1"><a class="header-anchor" href="#_0-前言"><span>0. 前言</span></a></h2><p>在这之前，我们已经学会了如何准备一个Lagrange.oneBot服务器，并让服务器登录我们的QQ，并且还学习了开发QQ机器人必须掌握的前置知识。接下来，我们还需要编写对应的代码来实现和QQ机器人的交互。如&quot;前言&quot;章节所说，如果你有一定的编程基础，会编程发送Http请求，那么即便不用本教材的Lagrange.oneBot整合TypeScript的方式也可以开发</p><p>不过如果你有JS或者TS的基础，我建议你可以选择这个整合版的框架，还是比较好用的</p><h2 id="_1-拉取和配置项目" tabindex="-1"><a class="header-anchor" href="#_1-拉取和配置项目"><span>1. 拉取和配置项目</span></a></h2><p>在你的电脑上任意位置新建一个文件夹，专门用来存放QQ机器人的项目代码，然后打开任意命令行工具，在命令行中输入如下命令：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># npm</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">npm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> lagrange.onebot</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># yarn</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">yarn</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> add</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> lagrange.onebot</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面的两个安装命令二选一即可，用你自己喜欢的包管理器安装本项目的初始代码</p><p>安装好之后，在项目目录下寻找一个叫做<code>tsconfig.json</code>的文件，开启装饰器：</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">{</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">    &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">compilerOptions</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        ...</span></span>
<span class="line"><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">        &quot;</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">experimentalDecorators</span><span style="--shiki-light:#99841877;--shiki-dark:#B8A96577;">&quot;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">        ...</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">    }</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>默认应该是开着的，不过以防万一检查一下比较好，确保上面代码中的这个字段的值是<code>true</code></p><h2 id="_2-初步了解本项目" tabindex="-1"><a class="header-anchor" href="#_2-初步了解本项目"><span>2. 初步了解本项目</span></a></h2><p>在安装的项目中，默认是已经准备好了一些文件的。找到test目录下的一个叫做<code>main.ts</code>的文件，建议你之后在开发的时候把这个文件当作程序的执行入口。<code>main.ts</code>的初始代码如下：</p><div class="language-typescript line-numbers-mode" data-ext="typescript" data-title="typescript"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// main.ts</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;"> server</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> }</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> from</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">lagrange.onebot</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">import</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">./impl</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// server 刚启动的时候要做的事情</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">server</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">onMounted</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">c</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 向 QQ 号为 1193466151 的好友发送文本信息 &quot;成功上线&quot;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    c</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sendPrivateMsg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1193466151</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">成功上线</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">// server 即将关闭时要做的事情</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">server</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">onUnmounted</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">c</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> =&gt;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;"> {</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 向 QQ 号为 1193466151 的好友发送文本信息 &quot;成功下线&quot;</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">    c</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sendPrivateMsg</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">(</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1193466150</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">成功下线</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">);</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">server</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">.</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">run</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">({</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 拉格朗日服务器中的配置参数</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    host</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">: </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">127.0.0.1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    port</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">: </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">8080</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    path</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">: </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/onebot/v11/ws</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    // 阁下启动的机器人的 QQ 号</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">    qq</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">: </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1542544667</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">});</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面的QQ号是随便乱编的，请根据代码注释替换成你对应测试用的QQ号</p><p><code>server.onMounted</code>是框架提供的一个方法，当你的QQ机器人代码运行之后就会执行里面的内容，比如上面的代码中，机器人托管的QQ号上线之后会向&quot;1193466151&quot;这个QQ号发送一条消息&quot;成功上线&quot;</p><p>也就是说，<code>c.sendPrivateMsg();</code>这个方法的作用就是给指定QQ号的人发送一条消息</p><p>对于这些API，后面会有教程进行详细说明，这里只是初步了解项目</p><h2 id="_3-运行本项目" tabindex="-1"><a class="header-anchor" href="#_3-运行本项目"><span>3. 运行本项目</span></a></h2><p>众所周知，TypeScript必须得先编译成JavaScript才能执行</p><p>为了方便后续的运行，我们需要先安装一下TypeScript的编译器。笔者在开发的时候用的是VSCode，默认是没有TS的编译器的，因此这里如果你也没有编译器的话，可以打开命令行工具进入本项目文件路径下，然后输入：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">npm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -g</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ts-node</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>这样就可以全局安装一个ts的编译器了</p><p>然后还是用命令行工具在本项目的文件路径下，我们假设<code>main.ts</code>文件是在本项目根目录下的<code>test</code>文件夹中，那么根据文件的对应路径，应该输入如下代码编译运行：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">npx</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ts-node</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> test/main.ts</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>正常启动的控制台输入如下：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> INFORMATION</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">     2024-06-01</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 23:31:25</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   websocket</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 服务器创建完成</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> INFORMATION</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">     2024-06-01</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 23:31:29</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   完成</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> websocket</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 连接，启动参数如下</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">┌─────────┬──────────────────┐</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> (index) │      Values      │</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">├─────────┼──────────────────┤</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  host</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   │</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">   &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">127.0.0.1</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    │</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  port</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   │</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">       8080</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">       │</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  path</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   │</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/onebot/v11/ws</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> │</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">│</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   qq</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    │</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">    1542544558</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">    │</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">└─────────┴──────────────────┘</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> INFORMATION</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">     2024-06-01</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 23:31:29</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   消息处理管线注册完成</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面的QQ号对应的是你被机器人托管的QQ号，其它应该都是一样的</p><p>然后待程序正常编译运行之后，机器人托管的小号应该马上就会给你的测试账号发送&quot;成功上线&quot;的消息了：</p><p><img src="https://picx.zhimg.com/80/v2-582932c3b84177184ce83aa8d12ee94b_1440w.png" alt="1"></p><p>如果像上图一样，机器人QQ号给你的测试账号发送了消息，那么就说明项目启动成功啦🎉</p>`,30)]))}const k=i(l,[["render",t],["__file","index.html.vue"]]),d=JSON.parse(`{"path":"/qqbot/7i3r8be3/","title":"快速开始","lang":"zh-CN","frontmatter":{"title":"快速开始","createTime":"2024/09/05 14:06:19","permalink":"/qqbot/7i3r8be3/","head":[["script",{"id":"check-dark-mode"},";(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;if (um === 'dark' || (um !== 'light' && sm)) {document.documentElement.classList.add('dark');}})();"],["script",{"id":"check-mac-os"},"document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))"]]},"headers":[{"level":2,"title":"0. 前言","slug":"_0-前言","link":"#_0-前言","children":[]},{"level":2,"title":"1. 拉取和配置项目","slug":"_1-拉取和配置项目","link":"#_1-拉取和配置项目","children":[]},{"level":2,"title":"2. 初步了解本项目","slug":"_2-初步了解本项目","link":"#_2-初步了解本项目","children":[]},{"level":2,"title":"3. 运行本项目","slug":"_3-运行本项目","link":"#_3-运行本项目","children":[]}],"readingTime":{"minutes":3.64,"words":1092},"git":{},"filePathRelative":"notes/qqbot/开发教程/3.快速开始.md"}`);export{k as comp,d as data};
